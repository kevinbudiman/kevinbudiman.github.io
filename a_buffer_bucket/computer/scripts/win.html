<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>win</title>
	<meta name="generator" content="Zim 0.68">
	<meta name="viewport" content="width=device-width">
	<!-- <link href='http://fonts.googleapis.com/css?family=Open+Sans:300&subset=latin,greek,latin-ext' rel='stylesheet' type='text/css'> -->
	<![if !IE]>
	<!-- comment out for IE since it spams the user with warnings -->
	<script type='text/javascript' src='http://code.jquery.com/jquery-1.7.1.js'></script>
	<script type='text/javascript'>
		$(window).load(function(){$("#navigation").height( $("#content").height()+65 );});
	</script>
	<![endif]>
	<style>
		*, *:before, *:after {
  -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box;
		}
		body, html {
			height:100%;
			font-family:'Open Sans', sans-serif;
			line-height:1.5em;
			font-weight:300;
			background-color:#FAFAFA;
			text-rendering:geometricPrecision;
			margin:0;
			padding:0;
		}
		.wrapper {
			height:100%;
			padding: 1.25em;
			margin: .5em;
		}
		#navigation {
			background-color: #F3F3F3;
			border-right:1px solid #EAEAEA;
			padding: 1.25em;
		}
		

		#content {
			padding: 1.25em;
			margin-bottom: .5em;
			
		}
		#navigation ul {
			margin-top:0;
			margin-bottom:0;
			padding-left:40px;
		}
		#navigation li {
			list-style-type:none;
		}
		#navigation a {
			text-decoration:none;
			color:gray;
		}
		#navigation strong {
			color: #6E1308;
			font-weight:400;
		}
		#navigation a:hover {
			text-decoration:underline;
		}
		#content h1:nth-child(1) {
			margin-top:0;
		}
		h1,h2,h3,h4,h5,h6 {
			color: #6E6408;
			font-weight:300;
		}
		
			
		#content a {
			color :#6E1308;
		}
		#content a {
			text-decoration: none;
		}
		#content a:hover {
			text-decoration: underline;
		}
		#content a:active {
			text-decoration: underline;
		}
		#content strike {
			color: grey;
		}
		#content u {
			text-decoration: none;
			background-color: yellow;
		}
		#content tt {
			color: #6E1308;
		}
		#content pre {
			color: #6E1308;
			margin-left: 20px;
		}
		.backlinks {
			color:gray;
		}
		hr.footnotes {
			width: 20%;
			margin-left: 0;
		}

	@media (min-width: 47.5em ) and (orientation: landscape) {
	#content { margin-right: 19.5em; }

	#navigation { position: absolute; top: 0; right: 0; width: 18.75em;}   
	}
		

	</style>
</head>
<body>
	<div class="wrapper">
		<div id="navigation"> <ul>
<li><a href="../../../a_buffer_bucket.html" title="a buffer bucket" class="page">a buffer bucket</a>
<ul>
<li><a href="../../art.html" title="art" class="page">art</a></li>
<li><a href="../../business.html" title="business" class="page">business</a></li>
<li><a href="../../computer.html" title="computer" class="page">computer</a>
<ul>
<li><a href="../hackwifi.html" title="hackwifi" class="page">hackwifi</a></li>
<li><a href="../plan.html" title="plan" class="page">plan</a></li>
<li><a href="../programming.html" title="programming" class="page">programming</a></li>
<li><a href="../scripts.html" title="scripts" class="page">scripts</a>
<ul>
<li><a href="./scraper.html" title="scraper" class="page">scraper</a></li>
<li><b>win</b></li>
</ul>
</li>
<li><a href="../sharing.html" title="sharing" class="page">sharing</a></li>
</ul>
</li>
<li><a href="../../cooking.html" title="cooking" class="page">cooking</a></li>
<li><a href="../../kuliah.html" title="kuliah" class="page">kuliah</a></li>
<li><a href="../../small_shelf.html" title="small shelf" class="page">small shelf</a></li>
<li><a href="../../travel.html" title="travel" class="page">travel</a></li>
</ul>
</li>
<li><a href="../../../summaries.html" title="summaries" class="page">summaries</a></li>
<li><a href="../../../writings.html" title="writings" class="page">writings</a></li>
</ul>
 </div>
		<div id="content">
			<h1>win <a name='a buffer bucket:computer:scripts:win'></a></h1>

			<p>
Created Wednesday 11 October 2017
</p>

<p>
<span class="zim-tag">@rem</span> *<b> Disable Some Service </b>*<br>
sc stop DiagTrack<br>
sc stop diagnosticshub.standardcollector.service<br>
sc stop dmwappushservice<br>
sc stop WMPNetworkSvc<br>
sc stop WSearch
</p>

<p>
sc config DiagTrack start= disabled<br>
sc config diagnosticshub.standardcollector.service start= disabled<br>
sc config dmwappushservice start= disabled<br>
REM sc config RemoteRegistry start= disabled<br>
REM sc config TrkWks start= disabled<br>
sc config WMPNetworkSvc start= disabled<br>
sc config WSearch start= disabled<br>
REM sc config SysMain start= disabled
</p>

<p>
REM *<b> SCHEDULED TASKS tweaks </b>*<br>
REM schtasks /Change /TN "Microsoft\Windows\AppID\SmartScreenSpecific" /Disable<br>
schtasks /Change /TN "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser" /Disable<br>
schtasks /Change /TN "Microsoft\Windows\Application Experience\ProgramDataUpdater" /Disable<br>
schtasks /Change /TN "Microsoft\Windows\Application Experience\StartupAppTask" /Disable<br>
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\Consolidator" /Disable<br>
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\KernelCeipTask" /Disable<br>
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip" /Disable<br>
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\Uploader" /Disable<br>
schtasks /Change /TN "Microsoft\Windows\Shell\FamilySafetyUpload" /Disable<br>
schtasks /Change /TN "Microsoft\Office\OfficeTelemetryAgentLogOn" /Disable<br>
schtasks /Change /TN "Microsoft\Office\OfficeTelemetryAgentFallBack" /Disable<br>
schtasks /Change /TN "Microsoft\Office\Office 15 Subscription Heartbeat" /Disable
</p>

<p>
REM schtasks /Change /TN "Microsoft\Windows\Autochk\Proxy" /Disable<br>
REM schtasks /Change /TN "Microsoft\Windows\CloudExperienceHost\CreateObjectTask" /Disable<br>
REM schtasks /Change /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector" /Disable<br>
REM schtasks /Change /TN "Microsoft\Windows\DiskFootprint\Diagnostics" /Disable *** Not sure if should be disabled, maybe related to S.M.A.R.T.<br>
REM schtasks /Change /TN "Microsoft\Windows\FileHistory\File History (maintenance mode)" /Disable<br>
REM schtasks /Change /TN "Microsoft\Windows\Maintenance\WinSAT" /Disable<br>
REM schtasks /Change /TN "Microsoft\Windows\NetTrace\GatherNetworkInfo" /Disable<br>
REM schtasks /Change /TN "Microsoft\Windows\PI\Sqm-Tasks" /Disable<br>
REM The stubborn task Microsoft\Windows\SettingSync\BackgroundUploadTask can be Disabled using a simple bit change. I use a REG file for that (attached to this post).<br>
REM schtasks /Change /TN "Microsoft\Windows\Time Synchronization\ForceSynchronizeTime" /Disable<br>
REM schtasks /Change /TN "Microsoft\Windows\Time Synchronization\SynchronizeTime" /Disable<br>
REM schtasks /Change /TN "Microsoft\Windows\Windows Error Reporting\QueueReporting" /Disable<br>
REM schtasks /Change /TN "Microsoft\Windows\WindowsUpdate\Automatic App Update" /Disable
</p>

<br>

<p>
<span class="zim-tag">@rem</span> *<b> Remove Telemetry &amp; Data Collection </b>*<br>
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Metadata" /v PreventDeviceMetadataFromNetwork /t REG_DWORD /d 1 /f<br>
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f<br>
reg add "HKLM\SOFTWARE\Policies\Microsoft\MRT" /v DontOfferThroughWUAU /t REG_DWORD /d 1 /f<br>
reg add "HKLM\SOFTWARE\Policies\Microsoft\SQMClient\Windows" /v "CEIPEnable" /t REG_DWORD /d 0 /f<br>
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "AITEnable" /t REG_DWORD /d 0 /f<br>
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableUAR" /t REG_DWORD /d 1 /f<br>
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f<br>
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\AutoLogger\AutoLogger-Diagtrack-Listener" /v "Start" /t REG_DWORD /d 0 /f<br>
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\AutoLogger\SQMLogger" /v "Start" /t REG_DWORD /d 0 /f
</p>

<p>
<span class="zim-tag">@REM</span> Settings -&gt; Privacy -&gt; General -&gt; Let apps use my advertising ID...<br>
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f<br>
REM - SmartScreen Filter for Store Apps: Disable<br>
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost" /v EnableWebContentEvaluation /t REG_DWORD /d 0 /f<br>
REM - Let websites provide locally...<br>
reg add "HKCU\Control Panel\International\User Profile" /v HttpAcceptLanguageOptOut /t REG_DWORD /d 1 /f
</p>

<p>
<span class="zim-tag">@REM</span> WiFi Sense: HotSpot Sharing: Disable<br>
reg add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowWiFiHotSpotReporting" /v value /t REG_DWORD /d 0 /f<br>
<span class="zim-tag">@REM</span> WiFi Sense: Shared HotSpot Auto-Connect: Disable<br>
reg add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowAutoConnectToWiFiSenseHotspots" /v value /t REG_DWORD /d 0 /f
</p>

<p>
<span class="zim-tag">@REM</span> Change Windows Updates to "Notify to schedule restart"<br>
reg add "HKLM\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings" /v UxOption /t REG_DWORD /d 1 /f<br>
<span class="zim-tag">@REM</span> Disable P2P Update downlods outside of local network<br>
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" /v DODownloadMode /t REG_DWORD /d 0 /f
</p>

<br>

<p>
REM *<b> Hide the search box from taskbar. You can still search by pressing the Win key and start typing what you're looking for </b>*<br>
REM 0 = hide completely, 1 = show only icon, 2 = show long search box<br>
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v "SearchboxTaskbarMode" /t REG_DWORD /d 0 /f
</p>

<p>
REM *<b> Disable MRU lists (jump lists) of XAML apps in Start Menu </b>*<br>
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_TrackDocs" /t REG_DWORD /d 0 /f
</p>

<p>
REM *<b> Set Windows Explorer to start on This PC instead of Quick Access </b>*<br>
REM 1 = This PC, 2 = Quick access<br>
REM reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "LaunchTo" /t REG_DWORD /d 1 /f
</p>

<p>
<span class="zim-tag">@rem</span> Remove Apps<br>
PowerShell -Command "Get-AppxPackage *3DBuilder* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *Getstarted* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *WindowsAlarms* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *WindowsCamera* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *bing* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *MicrosoftOfficeHub* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *OneNote* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *people* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *WindowsPhone* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *photos* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *SkypeApp* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *solit* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *WindowsSoundRecorder* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *windowscommunicationsapps* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *zune* | Remove-AppxPackage"<br>
REM PowerShell -Command "Get-AppxPackage *WindowsCalculator* | Remove-AppxPackage"<br>
REM PowerShell -Command "Get-AppxPackage *WindowsMaps* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *Sway* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *CommsPhone* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *ConnectivityStore* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *Microsoft.Messaging* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *Facebook* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *Twitter* | Remove-AppxPackage"<br>
PowerShell -Command "Get-AppxPackage *Drawboard PDF* | Remove-AppxPackage"
</p>

<br>

<p>
<span class="zim-tag">@rem</span> NOW JUST SOME TWEAKS<br>
REM *<b> Show hidden files in Explorer </b>*<br>
REM reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Hidden" /t REG_DWORD /d 1 /f
</p>

<p>
REM *<b> Show super hidden system files in Explorer </b>*<br>
REM reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowSuperHidden" /t REG_DWORD /d 1 /f
</p>

<p>
REM *<b> Show file extensions in Explorer </b>*<br>
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideFileExt" /t  REG_DWORD /d 0 /f
</p>

<br>
<br>

<p>
REM *<b> Uninstall OneDrive </b>*<br>
start /wait "" "%SYSTEMROOT%\SYSWOW64\ONEDRIVESETUP.EXE" /UNINSTALL<br>
rd C:\OneDriveTemp /Q /S &gt;NUL 2&gt;&amp;1<br>
rd "%USERPROFILE%\OneDrive" /Q /S &gt;NUL 2&gt;&amp;1<br>
rd "%LOCALAPPDATA%\Microsoft\OneDrive" /Q /S &gt;NUL 2&gt;&amp;1<br>
rd "%PROGRAMDATA%\Microsoft OneDrive" /Q /S &gt;NUL 2&gt;&amp;1<br>
reg add "HKEY_CLASSES_ROOT\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}\ShellFolder" /f /v Attributes /t REG_DWORD /d 0 &gt;NUL 2&gt;&amp;1<br>
reg add "HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}\ShellFolder" /f /v Attributes /t REG_DWORD /d 0 &gt;NUL 2&gt;&amp;1<br>
echo OneDrive has been removed. Windows Explorer needs to be restarted.<br>
pause<br>
start /wait TASKKILL /F /IM explorer.exe<br>
start explorer.exe
</p>


			<br>
			<span class="backlinks">
			</span>

			
		</div>
	</div>
</body>
</html>

